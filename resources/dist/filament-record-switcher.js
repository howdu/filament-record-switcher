function g({getResultsUsing:n,hasDynamicSearchResults:o,label:u,loadingMessage:l,noSearchResultsMessage:d,optionsLimit:h,placeholder:r,searchPrompt:a,searchingMessage:f,state:c,updateSelected:C}){return{isSearching:!1,select:null,selectedOptions:[],isStateBeingUpdated:!1,state:c,init:async function(){this.select=new Choices(this.$refs.input,{allowHTML:!0,duplicateItemsAllowed:!1,itemSelectText:"",loadingText:l,maxItemCount:-1,noChoicesText:a,noResultsText:d,placeholderValue:r,removeItemButton:!1,renderChoiceLimit:h,searchEnabled:!0,searchFields:["label"],searchPlaceholderValue:a,searchResultLimit:h,shouldSort:!1,searchFloor:o?0:1,classNames:{containerOuter:"choices choices__select__changer",item:"choices__item choices__select__changer__item"}}),this.refreshPlaceholder(),this.$refs.input.addEventListener("showDropdown",async()=>{this.select.clearChoices(),await this.select.setChoices([{label:l,value:"",disabled:!0}]),await this.refreshChoices()}),this.$refs.input.addEventListener("change",async()=>{this.refreshPlaceholder();let e=this.select.getValue(!0)??null;return this.setChoices([{label:u,value:c,selected:!0}]),await C(e)}),this.$refs.input.addEventListener("search",async e=>{var t;let i=(t=e.detail.value)==null?void 0:t.trim();this.isSearching=!0,this.select.clearChoices(),await this.select.setChoices([{label:[null,void 0,""].includes(i)?l:f,value:"",disabled:!0}])}),this.$refs.input.addEventListener("search",Alpine.debounce(async e=>{var i;await this.refreshChoices({search:(i=e.detail.value)==null?void 0:i.trim()}),this.isSearching=!1},250)),this.$wire.on("record-switcher:refresh",e=>{this.select.clearChoices(),this.select.setChoices([{label:e.label,value:c,selected:!0}])})},refreshChoices:async function(e={}){const i=await this.getChoices(e);if(this.refreshPlaceholder(),this.setChoices(i),![null,void 0,""].includes(this.state)){const t=this.state,s=this.select.dropdown.getChild(`.choices__item[data-value="${t}"]`);s&&(this.select._highlightChoice(s),setTimeout(()=>s.scrollIntoView({block:"nearest"}),100))}},setChoices:function(e){this.select.setChoices(e,"value","label",!0)},getChoices:async function({search:e}){let i=await n(e),t={};return i.forEach(function(s,_){s.group&&(t[s.group]||(t[s.group]={label:s.group,id:s.group,disabled:!1,choices:[]}),t[s.group].choices.push(s))}),Object.keys(t).length===0?i:Object.values(t)},refreshPlaceholder:function(){this.select._renderItems(),[null,void 0,""].includes(this.state)&&(this.$el.querySelector(".choices__list--single").innerHTML=`<div class="choices__placeholder choices__item">${r??""}</div>`)}}}export{g as default};
